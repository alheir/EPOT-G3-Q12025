Version 4
SHEET 1 2496 3908
WIRE -240 -192 -240 -240
WIRE -240 -80 -240 -112
WIRE 704 96 624 96
WIRE 816 96 768 96
WIRE 912 96 816 96
WIRE 816 112 816 96
WIRE 240 144 160 144
WIRE 624 192 624 176
WIRE 816 192 816 176
WIRE 816 192 624 192
WIRE 912 192 816 192
WIRE 912 208 912 192
WIRE 240 272 240 224
WIRE 192 352 112 352
WIRE 704 368 624 368
WIRE 816 368 768 368
WIRE 912 368 816 368
WIRE 816 384 816 368
WIRE 240 400 240 368
WIRE 624 464 624 448
WIRE 816 464 816 448
WIRE 816 464 624 464
WIRE 912 464 816 464
WIRE 912 480 912 464
WIRE 800 752 800 720
WIRE 896 752 800 752
WIRE 928 752 896 752
WIRE 1040 752 1008 752
WIRE 1120 752 1120 720
WIRE 1120 752 1040 752
WIRE 800 768 800 752
WIRE 1120 768 1120 752
WIRE 272 784 256 784
WIRE 1936 784 1856 784
WIRE 256 816 256 784
WIRE 272 816 256 816
WIRE 1856 832 1856 784
WIRE 256 848 256 816
WIRE 272 848 256 848
WIRE 256 880 256 848
WIRE 272 880 256 880
WIRE 2192 928 2080 928
WIRE 1904 960 1840 960
WIRE 1936 960 1936 784
WIRE 2080 960 2080 928
WIRE 2032 976 1968 976
WIRE 1904 992 1840 992
WIRE 1936 1040 1936 992
WIRE 2032 1040 2032 1024
WIRE 272 1680 112 1680
WIRE 464 1680 272 1680
WIRE 688 1680 464 1680
WIRE 1952 1680 1824 1680
WIRE 112 1728 112 1680
WIRE 528 1728 512 1728
WIRE 624 1728 528 1728
WIRE 1824 1728 1824 1680
WIRE 2112 1792 2048 1792
WIRE 624 1808 624 1728
WIRE 688 1808 688 1776
WIRE 688 1808 624 1808
WIRE 2112 1808 2112 1792
WIRE 624 1824 624 1808
WIRE 1824 1824 1824 1808
WIRE 2048 1824 2048 1792
WIRE 1952 1856 1952 1680
WIRE 112 1872 112 1808
WIRE 464 1872 464 1776
WIRE 560 1872 464 1872
WIRE 2064 1904 2048 1904
WIRE 624 1952 624 1920
WIRE 1280 1952 624 1952
WIRE 1840 1952 1280 1952
WIRE 2160 1952 1840 1952
WIRE 2064 1968 2064 1904
WIRE 2064 1968 2048 1968
WIRE 2160 1984 2160 1952
WIRE 272 2000 272 1680
WIRE 464 2000 464 1872
WIRE 624 2000 624 1952
WIRE 1280 2016 1280 1952
WIRE 2048 2032 2048 1968
WIRE 2048 2032 1936 2032
WIRE 2096 2032 2048 2032
WIRE 192 2048 176 2048
WIRE 208 2048 192 2048
WIRE 560 2048 528 2048
WIRE 1280 2048 1280 2016
WIRE 2048 2080 2048 2032
WIRE 368 2096 272 2096
WIRE 464 2096 368 2096
WIRE 368 2160 368 2096
WIRE 1840 2160 1840 1952
WIRE 1936 2160 1936 2032
WIRE 2160 2160 2160 2080
WIRE 2048 2176 2048 2144
WIRE 624 2192 624 2080
WIRE 1520 2208 1472 2208
WIRE 1648 2208 1600 2208
WIRE 1776 2208 1648 2208
WIRE 1872 2208 1776 2208
WIRE 1472 2224 1472 2208
WIRE 1280 2240 1280 2128
WIRE 1280 2240 1152 2240
WIRE 1152 2272 1152 2240
WIRE 1280 2288 1280 2240
WIRE 1840 2288 1840 2256
WIRE 1936 2288 1936 2256
WIRE 368 2304 368 2240
WIRE 1648 2304 1648 2208
WIRE 2160 2336 1904 2336
WIRE 1472 2352 1472 2304
WIRE 1744 2352 1712 2352
WIRE 1744 2384 1744 2352
WIRE 1280 2416 1280 2368
WIRE 1904 2464 1904 2336
WIRE 2256 2464 1936 2464
WIRE 1744 2480 1744 2464
WIRE 1872 2480 1744 2480
WIRE 2080 2496 1936 2496
WIRE 2256 2512 2256 2464
WIRE 1648 2528 1648 2400
WIRE 1904 2544 1904 2496
WIRE 2080 2544 2080 2496
WIRE 2256 2624 2256 2592
WIRE 2080 2656 2080 2624
FLAG -96 -112 0
FLAG -96 -192 Vd
FLAG 160 144 Vd
FLAG 912 96 Vo1+
FLAG 32 -112 0
FLAG 32 -192 Vg
FLAG 912 368 Vo2
FLAG 912 480 0
FLAG 912 192 Vo1-
FLAG 912 208 0
FLAG 1040 112 Vo1+
FLAG 1040 192 0
FLAG 1056 384 Vo2
FLAG 1056 464 0
FLAG 800 640 Vo2
FLAG 800 848 0
FLAG 1248 784 0
FLAG 1248 704 Vref
FLAG 1120 640 Vref
FLAG 1120 848 0
FLAG 144 1312 0
FLAG 144 1232 Vtriang
FLAG 1840 992 Vtriang
FLAG 1840 960 COMP
FLAG 1936 1040 0
FLAG 1856 912 0
FLAG 2032 1040 0
FLAG 2080 1040 0
FLAG 2192 928 Vcontrol
FLAG 240 400 0
FLAG 112 352 Vcontrol
FLAG 2048 2176 0
FLAG 2112 1808 0
FLAG 2160 2160 0
FLAG 1840 2288 0
FLAG 1936 2288 0
FLAG 1648 2528 0
FLAG 1904 2544 0
FLAG 2160 2416 0
FLAG 1472 2352 0
FLAG -240 -80 0
FLAG -240 -240 Vref2
FLAG 2080 2544 Vref2
FLAG 368 2304 0
FLAG 624 2192 0
FLAG 1152 2416 0
FLAG 1280 2416 0
FLAG 1280 2016 COMP
FLAG 896 752 V-
FLAG 1040 752 V+
FLAG 112 1872 0
FLAG 2080 2656 0
FLAG 2256 2624 0
FLAG 1824 1824 0
FLAG 560 2048 V+
FLAG 192 2048 V-
DATAFLAG 1600 1952 ""
SYMBOL ind2 640 192 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 127µ
SYMATTR Type ind
SYMBOL ind2 224 128 R0
SYMATTR InstName L1
SYMATTR Value 50.8m
SYMATTR Type ind
SYMBOL voltage -96 -208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 300 2m 0.1n 0 10)
SYMBOL voltage 32 -208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 0 0.1u 0.1u {D/fs} {1/fs})
SYMBOL ind2 640 464 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L3
SYMATTR Value 1.30m
SYMATTR Type ind
SYMBOL diode 704 112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value myDiode1
SYMBOL diode 704 384 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value myDiode1
SYMBOL cap 800 112 R0
WINDOW 123 24 84 Left 2
SYMATTR Value2 IC=0
SYMATTR InstName C1
SYMATTR Value 60µ
SYMBOL cap 800 384 R0
WINDOW 123 24 84 Left 2
SYMATTR Value2 iC=0
SYMATTR InstName C2
SYMATTR Value 3.13µ
SYMBOL res 1024 96 R0
SYMATTR InstName R1
SYMATTR Value 1.67
SYMBOL res 1040 368 R0
SYMATTR InstName R2
SYMATTR Value 32
SYMBOL MyPWMC 352 784 R0
SYMATTR InstName U1
SYMBOL res 784 624 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 784 752 R0
SYMATTR InstName R5
SYMATTR Value 1.8k
SYMBOL voltage 1248 688 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL res 1136 624 M0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 1136 752 M0
SYMATTR InstName R8
SYMATTR Value 9k
SYMBOL voltage 144 1216 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(1 3 0 {0.99/fs} {0.01/fs} 0 {1/fs})
SYMBOL voltage 1856 816 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 16
SYMBOL e 2080 944 R0
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL nmos 192 272 R0
SYMATTR InstName M1
SYMBOL MyComparator 1936 976 R0
SYMATTR InstName U2
SYMBOL cap 2032 2080 R0
SYMATTR InstName C4
SYMATTR Value 0.1µ
SYMBOL current 2048 1824 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value 100µ
SYMBOL pnp 2096 2080 M180
SYMATTR InstName Q1
SYMBOL npn 1872 2160 R0
SYMATTR InstName Q2
SYMBOL npn 1776 2160 R0
SYMATTR InstName Q3
SYMBOL npn 1712 2304 M0
SYMATTR InstName Q4
SYMBOL MyComparator 1904 2480 M0
SYMATTR InstName U3
SYMBOL voltage 2160 2320 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 5
SYMBOL voltage 1472 2208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 5
SYMBOL res 1728 2368 R0
SYMATTR InstName R9
SYMATTR Value 470
SYMBOL voltage -240 -208 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PULSE(0 5 2m 100n 0 10)
SYMBOL voltage 2256 2496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value 4.1
SYMBOL res 1616 2192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL npn 208 2000 R0
SYMATTR InstName Q5
SYMBOL npn 528 2000 M0
SYMATTR InstName Q6
SYMBOL current 368 2160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I2
SYMATTR Value 200µ
SYMBOL pnp 528 1776 R180
SYMATTR InstName Q7
SYMBOL pnp 560 1920 M180
SYMATTR InstName Q8
SYMBOL pnp 624 1776 M180
SYMATTR InstName Q9
SYMBOL current 624 2000 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I4
SYMATTR Value 100µ
SYMBOL res 1136 2256 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL cap 1136 2352 R0
SYMATTR InstName C5
SYMATTR Value 1n
SYMBOL res 1264 2272 R0
SYMATTR InstName R14
SYMATTR Value 500k
SYMBOL res 1296 2144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 100
SYMBOL voltage 112 1712 R0
SYMATTR InstName V10
SYMATTR Value 5
SYMBOL diode 1968 1920 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL voltage 1824 1712 R0
SYMATTR InstName V11
TEXT 352 64 Left 2 !K1 L1 L2 L3 1
TEXT 96 480 Left 2 !.tran 0 10m 0 0.01m
TEXT 96 504 Left 2 !.param D=0.238 fs=125e3 VD=0
TEXT 720 -168 Left 2 !.model MYSW SW(Ron=0.0001 Roff=100Meg Vt=.5 Vh=0.01)
TEXT 720 -136 Left 2 !.model myDiode1 D(Ron=0.0001 Roff=100Meg Vfwd={VD} Vrev=1000)
TEXT 1168 144 Left 2 ;5V@3A
TEXT 1168 424 Left 2 ;16V@500mA
TEXT 1160 808 Right 2 ;PRESET
